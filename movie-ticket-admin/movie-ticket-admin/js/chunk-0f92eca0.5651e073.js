(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0f92eca0"],{"22fc":function(e,t,a){"use strict";a.r(t);var n=a("1da1"),r=(a("96cf"),a("f8b7")),s=a("2934"),i=a("5c96"),o={name:"SnackManage",data:function(){return{tableData:[],total:0,currentPage:1,snackInfo:{},dialogFormVisible:!1,dialogTitle:"",labelPosition:"right",input:"",searchInput:"",addcinemaId:"",cinemaList:[],rules:{imageUrl:[{required:!0,message:"小吃图片不能为空",trigger:"blur"}],firstTitle:[{required:!0,message:"套餐名称不能为空",trigger:"blur"}],secondTitle:[{required:!0,message:"详细信息不能为空",trigger:"blur"}],price:[{required:!0,message:"价格不能为空",trigger:"blur"}],totalNumber:[{required:!0,message:"总数不能为空",trigger:"blur"}]}}},created:function(){this.loadCurrentPageSnack(this.currentPage,8,"")},methods:{loadCurrentPageSnack:function(e,t,a){var s=this;return Object(n.a)(regeneratorRuntime.mark((function n(){var i,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(r.g)({pageNum:e,limit:t,keyword:a});case 2:i=n.sent,o=i.data,200===i.status&&200===o.state&&(s.tableData=o.data.beanList,s.total=o.data.tr);case 6:case"end":return n.stop()}}),n)})))()},currentChange:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t.currentPage=e,t.loadCurrentPageSnack(t.currentPage,8,t.searchInput);case 2:case"end":return a.stop()}}),a)})))()},loadOptions:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(r.f)({});case 2:a=t.sent,n=a.data,200===a.status&&200===n.state&&(e.cinemaList=n.data.cinemas);case 6:case"end":return t.stop()}}),t)})))()},handleEdit:function(e,t){this.loadOptions(),this.dialogTitle="编辑小吃信息",this.snackInfo=t,this.addcinemaId="",this.dialogFormVisible=!0,console.log(e,t)},handleDelete:function(e,t){var a=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.MessageBox.confirm("此操作将永久删除该小吃信息, 是否继续？","提示").then(function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(n){var s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("confirm"!==n){e.next=7;break}return e.next=3,Object(r.b)({snackId:t.id});case 3:s=e.sent,o=s.data,200===s.status&&200===o.state&&(a.loadCurrentPageSnack(a.currentPage,8,a.searchInput),i.Message.success("删除该小吃成功！"));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})))()},changeImg:function(){var e=new FileReader;console.log(this.$refs.uploadImg.files),e.readAsDataURL(this.$refs.uploadImg.files[0]);var t=this;e.onload=function(){t.$refs.previewImg.src=this.result,t.snackInfo.imageUrl=this.result}},manageSnackInfo:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var a,n,o,l,c,u,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.snackInfo.imageUrl&&e.snackInfo.firstTitle&&e.snackInfo.secondTitle&&e.snackInfo.price&&e.snackInfo.totalNumber)){t.next=34;break}if(!e.$refs.uploadImg.files[0]){t.next=17;break}return a=new FormData,console.log(e.$refs.uploadImg.files[0]),a.append("img",e.$refs.uploadImg.files[0]),console.log(a),t.next=8,Object(s.a)(a);case 8:if(n=t.sent,o=n.data,200!==n.status||200!==o.state){t.next=15;break}o.data&&(e.snackInfo.imageUrl=o.data.img),t.next=17;break;case 15:return i.Message.error(o.message),t.abrupt("return");case 17:if("编辑小吃信息"!==e.dialogTitle){t.next=26;break}return t.next=20,Object(r.h)({snack:e.snackInfo});case 20:l=t.sent,c=l.data,200===l.status&&200===c.state?(e.dialogFormVisible=!1,i.Message.success("修改小吃信息成功！")):i.Message.error(c.message),t.next=32;break;case 26:return t.next=28,Object(r.h)({snack:e.snackInfo});case 28:u=t.sent,d=u.data,200===u.status&&200===d.state?(e.loadCurrentPageSnack(e.currentPage,8,e.searchInput),e.dialogFormVisible=!1,i.Message.success("添加小吃成功！")):i.Message.error(d.message);case 32:t.next=35;break;case 34:i.Message.error("请完成必填内容！");case 35:case"end":return t.stop()}}),t)})))()},search:function(){this.searchInput=this.input,this.loadCurrentPageSnack(1,8,this.searchInput)},addMovie:function(){this.loadOptions(),this.dialogTitle="添加小吃",this.snackInfo={},this.addcinemaId="",this.dialogFormVisible=!0},cancel:function(){this.dialogFormVisible=!1,this.loadCurrentPageSnack(this.currentPage,8,this.searchInput)}}},l=(a("9110"),a("2877")),c=Object(l.a)(o,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"movie-manage"}},[a("div",{staticClass:"top"},[a("el-col",{attrs:{span:12}},[a("el-input",{staticClass:"input-with-select",staticStyle:{width:"100%"},attrs:{placeholder:"请输入内容"},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"},[e._v("搜索")])],1)],1),a("el-col",{attrs:{span:2,offset:1}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addMovie}},[e._v("添加小吃")])],1)],1),a("div",{staticClass:"movie-table"},[a("el-table",{attrs:{border:"",data:e.tableData}},[a("el-table-column",{attrs:{label:"小吃 ID",align:"center",width:"100",prop:"id"}}),a("el-table-column",{attrs:{label:"所属影院",align:"center",width:"220",prop:"cinemaNm"}}),a("el-table-column",{attrs:{label:"套餐名称","show-overflow-tooltip":"",prop:"firstTitle"}}),a("el-table-column",{attrs:{label:"详细信息","show-overflow-tooltip":"",prop:"secondTitle"}}),a("el-table-column",{attrs:{label:"价格",align:"center","show-overflow-tooltip":"",prop:"price"}}),a("el-table-column",{attrs:{label:"已购数量",prop:"curNumber"}}),a("el-table-column",{attrs:{label:"剩余数量",align:"center",width:"100",prop:"totalNumber"}}),a("el-table-column",{attrs:{width:"200",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1),e.tableData.length?a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":8,"page-count":e.total},on:{"current-change":e.currentChange}})],1):e._e(),a("div",[e.dialogFormVisible?a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogFormVisible,"modal-append-to-body":!1,showClose:!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{"label-position":e.labelPosition,rules:e.rules,"label-width":"80px",model:e.snackInfo}},[a("el-form-item",{attrs:{label:"小吃图片",prop:"img"}},[a("el-col",{attrs:{span:16}},[a("img",{ref:"previewImg",attrs:{src:e.snackInfo.imageUrl,alt:"",width:"200px",height:"200px"}}),a("div",{staticStyle:{position:"relative",height:"64px"}},[a("el-button",{staticStyle:{position:"absolute",left:"0",top:"0",cursor:"pointer"},attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),a("input",{ref:"uploadImg",staticStyle:{position:"absolute",left:"0",top:"0",opacity:"0",height:"32px",width:"80px",cursor:"pointer"},attrs:{type:"file",id:"file",name:"file",accept:"image/png, image/jpeg, image/gif, image/jpg"},on:{change:e.changeImg}}),a("div",{staticClass:"el-upload__tip",staticStyle:{position:"absolute",left:"0",top:"32px",height:"32px"},attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)])],1),a("el-form-item",{attrs:{label:"影院名",prop:"cinemaNm"}},[a("el-col",{attrs:{span:12}},[e.snackInfo.cinemaId?a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.snackInfo.cinemaId,callback:function(t){e.$set(e.snackInfo,"cinemaId",t)},expression:"snackInfo.cinemaId"}},e._l(e.cinemaList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.nm,value:e.id}})})),1):a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择影院"},model:{value:e.snackInfo.cinemaId,callback:function(t){e.$set(e.snackInfo,"cinemaId",t)},expression:"snackInfo.cinemaId"}},e._l(e.cinemaList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.nm,value:e.id}})})),1)],1)],1),a("el-form-item",{attrs:{label:"套餐名称",prop:"firstTitle"}},[a("el-col",{attrs:{span:16}},[a("el-input",{model:{value:e.snackInfo.firstTitle,callback:function(t){e.$set(e.snackInfo,"firstTitle",t)},expression:"snackInfo.firstTitle"}})],1)],1),a("el-form-item",{attrs:{label:"详细信息",prop:"secondTitle"}},[a("el-col",{attrs:{span:16}},[a("el-input",{model:{value:e.snackInfo.secondTitle,callback:function(t){e.$set(e.snackInfo,"secondTitle",t)},expression:"snackInfo.secondTitle"}})],1)],1),a("el-form-item",{attrs:{label:"价格",prop:"price"}},[a("el-col",{attrs:{span:16}},[a("el-input",{model:{value:e.snackInfo.price,callback:function(t){e.$set(e.snackInfo,"price",t)},expression:"snackInfo.price"}})],1)],1),a("el-form-item",{attrs:{label:"已购",prop:"curNumber"}},[a("el-col",{attrs:{span:16}},[a("el-input",{model:{value:e.snackInfo.curNumber,callback:function(t){e.$set(e.snackInfo,"curNumber",t)},expression:"snackInfo.curNumber"}})],1)],1),a("el-form-item",{attrs:{label:"总数",prop:"totalNumber"}},[a("el-col",{attrs:{span:16}},[a("el-input",{model:{value:e.snackInfo.totalNumber,callback:function(t){e.$set(e.snackInfo,"totalNumber",t)},expression:"snackInfo.totalNumber"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancel}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.manageSnackInfo()}}},[e._v("确 定")])],1)],1):e._e()],1)])}),[],!1,null,null,null);t.default=c.exports},2934:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("a27e"),r=function(e){return Object(n.a)({url:"/admin/movie/upLoadFile",method:"POST",data:e,headers:{"Content-Type":"multipart/form-data"}})}},9110:function(e,t,a){"use strict";a("9fda")},"9fda":function(e,t,a){},f8b7:function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"g",(function(){return i})),a.d(t,"h",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"c",(function(){return d}));var n=a("a27e"),r=function(e){return Object(n.a)({url:"/admin/order/getOrders",method:"GET",params:e})},s=function(e){return Object(n.a)({url:"/admin/order/deleteOrder",method:"POST",data:e})},i=function(e){return Object(n.a)({url:"/admin/snack/getSnacks",method:"GET",params:e})},o=function(e){return Object(n.a)({url:"/admin/snack/addSnack",method:"POST",data:e})},l=function(e){return Object(n.a)({url:"/admin/snack/deleteSnack",method:"POST",data:e})},c=function(e){return Object(n.a)({url:"/admin/hall/getOptions",method:"GET",params:e})},u=function(e){return Object(n.a)({url:"/admin/order/getOrders",method:"GET",params:e})},d=function(e){return Object(n.a)({url:"/admin/snack/getSnacks",method:"GET",params:e})}}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-28276d19"],{"25f0":function(e,t,a){"use strict";var n=a("6eeb"),r=a("825a"),i=a("d039"),o=a("ad6d"),l="toString",s=RegExp.prototype,c=s[l],u=i((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),d=c.name!=l;(u||d)&&n(RegExp.prototype,l,(function(){var e=r(this),t=String(e.source),a=e.flags;return"/"+t+"/"+String(void 0===a&&e instanceof RegExp&&!("flags"in s)?o.call(e):a)}),{unsafe:!0})},"3c2f":function(e,t,a){"use strict";a("f9f9")},"4d63":function(e,t,a){var n=a("83ab"),r=a("da84"),i=a("94ca"),o=a("7156"),l=a("9bf2").f,s=a("241c").f,c=a("44e7"),u=a("ad6d"),d=a("9f7f"),f=a("6eeb"),m=a("d039"),p=a("69f3").set,b=a("2626"),g=a("b622")("match"),h=r.RegExp,v=h.prototype,I=/a/g,w=/a/g,x=new h(I)!==I,k=d.UNSUPPORTED_Y;if(n&&i("RegExp",!x||k||m((function(){return w[g]=!1,h(I)!=I||h(w)==w||"/a/i"!=h(I,"i")})))){for(var C=function(e,t){var a,n=this instanceof C,r=c(e),i=void 0===t;if(!n&&r&&e.constructor===C&&i)return e;x?r&&!i&&(e=e.source):e instanceof C&&(i&&(t=u.call(e)),e=e.source),k&&((a=!!t&&t.indexOf("y")>-1)&&(t=t.replace(/y/g,"")));var l=o(x?new h(e,t):h(e,t),n?this:v,C);return k&&a&&p(l,{sticky:a}),l},y=function(e){e in C||l(C,e,{configurable:!0,get:function(){return h[e]},set:function(t){h[e]=t}})},B=s(h),P=0;B.length>P;)y(B[P++]);v.constructor=C,C.prototype=v,f(r,"RegExp",C)}b("RegExp")},7156:function(e,t,a){var n=a("861d"),r=a("d2bb");e.exports=function(e,t,a){var i,o;return r&&"function"==typeof(i=t.constructor)&&i!==a&&n(o=i.prototype)&&o!==a.prototype&&r(e,o),e}},ecf0:function(e,t,a){"use strict";a.r(t);var n=a("1da1"),r=(a("4d63"),a("ac1f"),a("25f0"),a("96cf"),a("5c96")),i=a("a27e"),o=function(e){return Object(i.a)({url:"/admin/cinema/getCinemas",method:"GET",params:e})},l=function(e){return Object(i.a)({url:"/admin/cinema/getBrandList",method:"GET",params:e})},s=function(e){return Object(i.a)({url:"/admin/cinema/addCinema",method:"POST",data:e})},c=function(e){return Object(i.a)({url:"/admin/cinema/deleteCinema",method:"POST",data:e})},u=function(e){return Object(i.a)({url:"/admin/cinema/addCinemaBrand",method:"POST",data:e})},d=a("2b0e"),f={name:"CinemaManage",data:function(){return{tableData:[],total:0,currentPage:1,cinemaInfo:{},brandList:[],dialogFormVisible:!1,dialogTitle:"",newBrand:"",addBrandId:"",labelPosition:"right",input:"",searchInput:"",booleanOpitons:[{value:"支持",label:"支持"},{value:"不支持",label:"不支持"}],rules:{cinema_name:[{required:!0,message:"影院名不能为空",trigger:"blur"}],cinema_phone:[{required:!0,message:"影院电话不能为空",trigger:"blur"},{validator:function(e,t,a){t?/^1[3|4|5|6|7|8][0-9]{9}$/.test(t)?a():a(new Error("请输入正确格式的手机号码")):a(new Error("请输入手机号码"))},trigger:"blur"}],specified_address:[{required:!0,message:"影院地址不能为空",trigger:"blur"}]}}},created:function(){this.loadCurrentPageCinema(this.currentPage,8,"")},methods:{loadCurrentPageCinema:function(e,t,a){var r=this;return Object(n.a)(regeneratorRuntime.mark((function n(){var i,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o({pageNum:e,limit:t,keyword:a});case 2:i=n.sent,l=i.data,200===i.status&&200===l.state&&(r.tableData=l.data.beanList,r.total=l.data.tr);case 6:case"end":return n.stop()}}),n)})))()},loadBrandList:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l({});case 2:a=t.sent,n=a.data,200===a.status&&200===n.state&&(e.brandList=n.data);case 6:case"end":return t.stop()}}),t)})))()},formatBoolean:function(e,t,a){return a?"支持":"不支持"},handleEdit:function(e,t){this.loadBrandList(),this.dialogTitle="编辑影院信息",this.cinemaInfo=t,this.dialogFormVisible=!0,this.newBrand="",console.log(e,t)},handleDelete:function(e,t){var a=this;console.log(e,t),r.MessageBox.confirm("此操作将永久删除该影院所有信息, 是否继续？","提示").then(function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(n){var i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("confirm"!==n){e.next=7;break}return e.next=3,c({cinemaId:t.id});case 3:i=e.sent,o=i.data,200===i.status&&200===o.state&&(r.Message.success("删除该影院成功！"),a.loadCurrentPageCinema(a.currentPage,8,a.searchInput));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),console.log(e,t)},selectBlur:function(e){this.cinemaInfo.brandId=e.target.value,this.newBrand=e.target.value,this.addBrandId=e.target.value},manageCinemaInfo:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var a,n,i,o,l,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.cinemaInfo.nm&&e.cinemaInfo.addr){t.next=4;break}r.Message.error("请完成必填内容！"),t.next=37;break;case 4:if(!new RegExp("[\\u4E00-\\u9FFF]+","g").test(e.newBrand)){t.next=20;break}return t.next=8,u({newBrand:e.newBrand});case 8:if(a=t.sent,n=a.data,200!==a.status||200!==n.state){t.next=17;break}e.cinemaInfo.brandId=n.data,e.newBrand="",e.loadBrandList(),t.next=20;break;case 17:return console.log(n.message),r.Message.error(n.message),t.abrupt("return");case 20:if(d.default.delete(e.cinemaInfo,"brandName"),"编辑影院信息"!==e.dialogTitle){t.next=30;break}return t.next=24,s({cinema:e.cinemaInfo});case 24:i=t.sent,o=i.data,200===i.status&&200===o.state?(e.loadCurrentPageCinema(e.currentPage,8,e.searchInput),e.dialogFormVisible=!1,r.Message.success("修改影院信息成功！")):r.Message.error(o.message),t.next=37;break;case 30:return e.cinemaInfo.brandId||(e.cinemaInfo.brandId=e.addBrandId),t.next=33,s({cinema:e.cinemaInfo});case 33:l=t.sent,c=l.data,200===l.status&&200===c.state?(e.loadCurrentPageCinema(e.currentPage,8,e.searchInput),e.dialogFormVisible=!1,e.addBrandId="",r.Message.success("添加影院成功！")):r.Message.error(c.message);case 37:case"end":return t.stop()}}),t)})))()},currentChange:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t.currentPage=e,t.loadCurrentPageCinema(t.currentPage,8,t.searchInput);case 2:case"end":return a.stop()}}),a)})))()},search:function(){this.searchInput=this.input,this.loadCurrentPageCinema(1,8,this.searchInput)},addCinema:function(){this.loadBrandList(),this.dialogTitle="添加影院",this.cinemaInfo={},this.newBrand="",this.dialogFormVisible=!0},cancel:function(){this.loadCurrentPageCinema(this.currentPage,8,this.searchInput),this.dialogFormVisible=!1}}},m=(a("3c2f"),a("2877")),p=Object(m.a)(f,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"cinema-manage"}},[a("div",{staticClass:"top"},[a("el-col",{attrs:{span:12}},[a("el-input",{staticClass:"input-with-select",staticStyle:{width:"100%"},attrs:{placeholder:"请输入内容"},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"},[e._v("搜索")])],1)],1),a("el-col",{attrs:{span:2,offset:1}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addCinema}},[e._v("添加影院")])],1)],1),a("div",{staticClass:"cinema-table"},[a("el-table",{attrs:{border:"",data:e.tableData}},[a("el-table-column",{attrs:{label:"影院 ID",align:"center",width:"70",prop:"id"}}),a("el-table-column",{attrs:{label:"影院名",width:"220",prop:"nm"}}),a("el-table-column",{attrs:{label:"所属品牌",align:"center",width:"120",prop:"brandName"}}),a("el-table-column",{attrs:{label:"详细地址","show-overflow-tooltip":"",prop:"addr"}}),a("el-table-column",{attrs:{label:"是否支持改签",width:"110",prop:"endorse",formatter:e.formatBoolean}}),a("el-table-column",{attrs:{label:"是否支持退票",width:"110",prop:"allowrefund",formatter:e.formatBoolean}}),a("el-table-column",{attrs:{width:"200",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1),e.tableData.length?a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":8,"page-count":e.total},on:{"current-change":e.currentChange}})],1):e._e(),a("div",[e.dialogFormVisible?a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogFormVisible,"modal-append-to-body":!1,showClose:!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{"label-position":e.labelPosition,"label-width":"80px",model:e.cinemaInfo,rules:e.rules}},[a("el-form-item",{attrs:{label:"影院名",prop:"nm"}},[a("el-col",{attrs:{span:18}},[a("el-input",{model:{value:e.cinemaInfo.nm,callback:function(t){e.$set(e.cinemaInfo,"nm",t)},expression:"cinemaInfo.nm"}})],1)],1),a("el-form-item",{attrs:{label:"所属品牌",prop:"brandId"}},[a("el-col",{attrs:{span:18}},[e.cinemaInfo.id?a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择"},on:{blur:e.selectBlur},model:{value:e.cinemaInfo.brandId,callback:function(t){e.$set(e.cinemaInfo,"brandId",t)},expression:"cinemaInfo.brandId"}},e._l(e.brandList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.brand,value:e.id}})})),1):a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择"},on:{blur:e.selectBlur},model:{value:e.addBrandId,callback:function(t){e.addBrandId=t},expression:"addBrandId"}},e._l(e.brandList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.brand,value:e.id}})})),1)],1)],1),a("el-form-item",{attrs:{label:"地址",prop:"addr"}},[a("el-col",{attrs:{span:18}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.cinemaInfo.addr,callback:function(t){e.$set(e.cinemaInfo,"addr",t)},expression:"cinemaInfo.addr"}})],1)],1),a("el-form-item",{attrs:{label:"改签",prop:"endorse"}},[a("el-col",{attrs:{span:16}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.cinemaInfo.endorse,callback:function(t){e.$set(e.cinemaInfo,"endorse",t)},expression:"cinemaInfo.endorse"}},[a("el-option",{attrs:{label:"支持",value:!0}}),a("el-option",{attrs:{label:"不支持",value:!1}})],1)],1)],1),a("el-form-item",{attrs:{label:"退票",prop:"allowrefund"}},[a("el-col",{attrs:{span:16}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.cinemaInfo.allowrefund,callback:function(t){e.$set(e.cinemaInfo,"allowrefund",t)},expression:"cinemaInfo.allowrefund"}},[a("el-option",{attrs:{label:"支持",value:!0}}),a("el-option",{attrs:{label:"不支持",value:!1}})],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancel}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.manageCinemaInfo()}}},[e._v("确 定")])],1)],1):e._e()],1)])}),[],!1,null,null,null);t.default=p.exports},f9f9:function(e,t,a){}}]);
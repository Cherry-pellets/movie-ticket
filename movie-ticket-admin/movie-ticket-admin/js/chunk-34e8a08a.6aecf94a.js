(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-34e8a08a"],{"069c":function(e,t,a){},"1dde":function(e,t,a){var n=a("d039"),l=a("b622"),r=a("2d00"),i=l("species");e.exports=function(e){return r>=51||!n((function(){var t=[];return(t.constructor={})[i]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"53a6":function(e,t,a){"use strict";a.d(t,"e",(function(){return l})),a.d(t,"f",(function(){return r})),a.d(t,"g",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"h",(function(){return o})),a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return d})),a.d(t,"d",(function(){return u}));var n=a("a27e"),l=function(e){return Object(n.a)({url:"/admin/hall/getHalls",method:"GET",params:e})},r=function(e){return Object(n.a)({url:"/admin/hall/getOptions",method:"GET",params:e})},i=function(e){return Object(n.a)({url:"/admin/hall/getSeatByHallId",method:"GET",params:e})},s=function(e){return Object(n.a)({url:"/admin/hall/deleteHall",method:"POST",data:e})},o=function(e){return Object(n.a)({url:"/admin/hall/updateHall",method:"POST",data:e})},c=function(e){return Object(n.a)({url:"/admin/hall/addHall",method:"POST",data:e})},d=function(e){return Object(n.a)({url:"/admin/hall/commitSeat",method:"POST",data:e})},u=function(e){return Object(n.a)({url:"/admin/hall/getHalls",method:"GET",params:e})}},"65f0":function(e,t,a){var n=a("861d"),l=a("e8b5"),r=a("b622")("species");e.exports=function(e,t){var a;return l(e)&&("function"!=typeof(a=e.constructor)||a!==Array&&!l(a.prototype)?n(a)&&(null===(a=a[r])&&(a=void 0)):a=void 0),new(void 0===a?Array:a)(0===t?0:t)}},8418:function(e,t,a){"use strict";var n=a("c04e"),l=a("9bf2"),r=a("5c6c");e.exports=function(e,t,a){var i=n(t);i in e?l.f(e,i,r(0,a)):e[i]=a}},"8f20":function(e,t,a){"use strict";a.r(t);var n=a("1da1"),l=(a("a434"),a("96cf"),a("c91c")),r=a("5c96"),i=a("53a6"),s={name:"HallManage",data:function(){return{webConfig:l.a,tableData:[],total:0,currentPage:1,hallInfo:{},cinemaList:[],hallTypeList:[],dialogFormVisible:!1,dialogTitle:"",labelPosition:"right",input:"",searchInput:"",hallOldName:"",addDialogFormVisible:!1,seatDialogFormVisible:!1,loadingDialogFormVisible:!1,seat:[[]],seats:[],changeSeat:[],newSeat:[],addcinemaId:"",addHallTypeId:"",xSeat:15,ySeat:15,rules:{addcinemaId:[{required:!0,message:"影院名不能为空",trigger:"change"}],addHallTypeId:[{required:!0,message:"影厅名不能为空",trigger:"blur"}]}}},created:function(){this.loadCurrentPageHall(this.currentPage,8,"")},methods:{loadCurrentPageHall:function(e,t,a){var l=this;return Object(n.a)(regeneratorRuntime.mark((function n(){var r,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(i.e)({pageNum:e,limit:t,keyword:a});case 2:r=n.sent,s=r.data,200===r.status&&200===s.state&&(l.tableData=s.data.beanList,l.total=s.data.tr);case 6:case"end":return n.stop()}}),n)})))()},loadOptions:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(i.f)({});case 2:a=t.sent,n=a.data,200===a.status&&200===n.state&&(e.hallTypeList=n.data.hallTypes,e.cinemaList=n.data.cinemas);case 6:case"end":return t.stop()}}),t)})))()},currentChange:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t.currentPage=e,t.loadCurrentPageHall(t.currentPage,8,t.searchInput);case 2:case"end":return a.stop()}}),a)})))()},manageHallInfo:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("编辑影厅信息"!==e.dialogTitle){t.next=11;break}if(!e.hallInfo.cinemaId||!e.hallInfo.hallTypeId){t.next=10;break}return t.next=4,Object(i.h)({hallId:e.hallInfo.id,cinemaId:e.hallInfo.cinemaId,hallTypeId:e.hallInfo.hallTypeId});case 4:a=t.sent,n=a.data,200===a.status&&200===n.state?(e.dialogFormVisible=!1,e.loadCurrentPageHall(e.currentPage,8,e.searchInput),r.Message.success("修改影厅信息成功！")):r.Message.error(n.message),t.next=11;break;case 10:r.Message.error("请完成必填内容！");case 11:case"end":return t.stop()}}),t)})))()},handleEdit:function(e,t){this.loadOptions(),this.dialogTitle="编辑影厅信息",this.hallInfo=t,this.dialogFormVisible=!0,console.log(e,t)},handleSeat:function(e,t){this.dialogTitle="影厅座位信息",this.hallInfo=t,this.seats=[],this.seat=[],this.newSeat=[],this.changeSeat=[],this.setSeat(),this.seatDialogFormVisible=!0},handleDelete:function(e,t){var a=this;console.log(e,t),r.MessageBox.confirm("此操作将永久删除该影厅所有信息, 是否继续？","提示").then(function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(n){var l,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("confirm"!==n){e.next=7;break}return e.next=3,Object(i.c)({hallId:t.id});case 3:l=e.sent,s=l.data,200===l.status&&200===s.state&&(r.Message.success("删除该影厅成功！"),a.loadCurrentPageHall(a.currentPage,8,a.searchInput));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),console.log(e,t)},search:function(){this.searchInput=this.input,this.loadCurrentPageHall(1,8,this.searchInput)},cancel:function(){this.loadCurrentPageHall(this.currentPage,8,this.searchInput),this.dialogFormVisible=!1},addHall:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.loadOptions(),e.addcinemaId="",e.addHallTypeId="",e.hallInfo={},e.addDialogFormVisible=!0;case 5:case"end":return t.stop()}}),t)})))()},commitAddHall:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(i.a)({cinemaId:e.addcinemaId,halltypeId:e.addHallTypeId});case 2:a=t.sent,n=a.data,200===a.status&&200===n.state?(e.addDialogFormVisible=!1,r.Message.success("添加影厅成功！"),e.loadCurrentPageHall(e.currentPage,8,e.searchInput)):1===n.error_code&&r.Message.error(n.message);case 6:case"end":return t.stop()}}),t)})))()},setSeat:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var a,n,l,r,s,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.seat=[],e.seats=[],t.next=4,Object(i.g)({hallId:e.hallInfo.id});case 4:for(a=t.sent,n=a.data,e.seats=n.data,l=[],r=0;r<e.ySeat;r++)for(l[r]=[],s=0;s<e.xSeat;s++)l[r][s]={xCoord:s+1,yCoord:r+1,iconSrc:"noSeat.png"};if(e.seats.length>0)for(o=0;o<e.seats.length;o++)"danren"===e.seats[o].type?e.seats[o].iconSrc="seatPre.png":e.seats[o].iconSrc="noSeat.png",l[e.seats[o].yCoord-1][e.seats[o].xCoord-1]=e.seats[o];e.seat=l,console.log(e.seat);case 12:case"end":return t.stop()}}),t)})))()},changSeat:function(e,t,a){if(console.log(t,a),"noSeat.png"===this.seat[t][a].iconSrc?this.seat[t][a].iconSrc="seatPre.png":this.seat[t][a].iconSrc="noSeat.png",this.seat.push(),e.id){var n=this.changeSeat.indexOf(e);-1!=n?this.changeSeat.splice(n,1):this.changeSeat.push(e),console.log(this.changeSeat)}else{var l=this.newSeat.indexOf(e);-1!=l?this.newSeat.splice(l,1):this.newSeat.push(e),console.log(this.newSeat)}},commitSeat:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.newSeat.length>0||e.changeSeat.length>0)){t.next=8;break}return e.loadingDialogFormVisible=!0,t.next=4,Object(i.b)({hallId:e.hallInfo.id,newSeat:JSON.stringify(e.newSeat),changeSeat:JSON.stringify(e.changeSeat)});case 4:a=t.sent,n=a.data,200===a.status&&200===n.state?(e.loadingDialogFormVisible=!1,e.seatDialogFormVisible=!1,r.Message.success("修改座位信息成功！"),e.loadCurrentPageHall(e.currentPage,8,e.searchInput)):r.Message.error(n.message);case 8:case"end":return t.stop()}}),t)})))()}}},o=(a("d902"),a("2877")),c=Object(o.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"hall-manage"}},[a("div",{staticClass:"top"},[a("el-col",{attrs:{span:12}},[a("el-input",{staticClass:"input-with-select",staticStyle:{width:"100%"},attrs:{placeholder:"请输入内容"},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"},[e._v("搜索")])],1)],1),a("el-col",{attrs:{span:2,offset:1}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addHall}},[e._v("添加影厅")])],1)],1),a("div",{staticClass:"hall-table"},[a("el-table",{attrs:{border:"",data:e.tableData}},[a("el-table-column",{attrs:{label:"影厅 ID",align:"center",width:"100",prop:"id"}}),a("el-table-column",{attrs:{label:"影院名",width:"250",prop:"cinemaNm"}}),a("el-table-column",{attrs:{label:"影厅名","show-overflow-tooltip":"",prop:"hallType"}}),a("el-table-column",{attrs:{width:"100",align:"center",label:"影厅座位"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(a){return e.handleSeat(t.$index,t.row)}}},[e._v("座位")])]}}])}),a("el-table-column",{attrs:{width:"200",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1),e.tableData.length?a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":8,"page-count":e.total},on:{"current-change":e.currentChange}})],1):e._e(),a("div",[e.dialogFormVisible?a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogFormVisible,"modal-append-to-body":!1,showClose:!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{"label-position":e.labelPosition,rules:e.rules,"label-width":"80px",model:e.hallInfo}},[a("el-form-item",{attrs:{label:"影院名",prop:"cinemaNm"}},[a("el-col",{attrs:{span:18}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择影院"},model:{value:e.hallInfo.cinemaId,callback:function(t){e.$set(e.hallInfo,"cinemaId",t)},expression:"hallInfo.cinemaId"}},e._l(e.cinemaList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.nm,value:e.id}})})),1)],1)],1),a("el-form-item",{attrs:{label:"影厅名",prop:"hallType"}},[a("el-col",{attrs:{span:18}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择类型"},model:{value:e.hallInfo.hallTypeId,callback:function(t){e.$set(e.hallInfo,"hallTypeId",t)},expression:"hallInfo.hallTypeId"}},e._l(e.hallTypeList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.halltype,value:e.id}})})),1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancel}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.manageHallInfo()}}},[e._v("确 定")])],1)],1):e._e()],1),a("div",[e.addDialogFormVisible?a("el-dialog",{attrs:{title:"添加影厅",visible:e.addDialogFormVisible,"modal-append-to-body":!1,"show-close":!1},on:{"update:visible":function(t){e.addDialogFormVisible=t}}},[a("el-form",{attrs:{"label-position":e.labelPosition,rules:e.rules,"label-width":"80px",model:e.hallInfo}},[a("el-form-item",{attrs:{label:"影院名",prop:"cinemaNm"}},[a("el-col",{attrs:{span:12}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.addcinemaId,callback:function(t){e.addcinemaId=t},expression:"addcinemaId"}},e._l(e.cinemaList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.nm,value:e.id}})})),1)],1)],1),a("el-form-item",{attrs:{label:"影厅名",prop:"hallType"}},[a("el-col",{attrs:{span:12}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.addHallTypeId,callback:function(t){e.addHallTypeId=t},expression:"addHallTypeId"}},e._l(e.hallTypeList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.halltype,value:e.id}})})),1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addDialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.commitAddHall()}}},[e._v("确 定")])],1)],1):e._e()],1),a("div",[e.seatDialogFormVisible?a("el-dialog",{attrs:{title:"座位信息",visible:e.seatDialogFormVisible,"modal-append-to-body":!1,"show-close":!1},on:{"update:visible":function(t){e.seatDialogFormVisible=t}}},[a("div",{staticClass:"seat"},e._l(e.seat,(function(t,n){return a("div",{key:n,staticClass:"x"},e._l(t,(function(t,l){return a("div",{key:l,staticClass:"y"},[a("img",{staticClass:"img",attrs:{src:""+e.webConfig.oss.sysImgPath+t.iconSrc},on:{click:function(a){return e.changSeat(t,n,l)}}})])})),0)})),0),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.seatDialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.commitSeat()}}},[e._v("确 定")])],1)]):e._e()],1),a("div",[e.loadingDialogFormVisible?a("el-dialog",{attrs:{title:"座位生成中...",visible:e.loadingDialogFormVisible,"modal-append-to-body":!1,"show-close":!1},on:{"update:visible":function(t){e.loadingDialogFormVisible=t}}},[a("div",{staticClass:"sk-fading-circle"},[a("div",{staticClass:"sk-circle sk-circle-1"}),a("div",{staticClass:"sk-circle sk-circle-2"}),a("div",{staticClass:"sk-circle sk-circle-3"}),a("div",{staticClass:"sk-circle sk-circle-4"}),a("div",{staticClass:"sk-circle sk-circle-5"}),a("div",{staticClass:"sk-circle sk-circle-6"}),a("div",{staticClass:"sk-circle sk-circle-7"}),a("div",{staticClass:"sk-circle sk-circle-8"}),a("div",{staticClass:"sk-circle sk-circle-9"}),a("div",{staticClass:"sk-circle sk-circle-10"}),a("div",{staticClass:"sk-circle sk-circle-11"}),a("div",{staticClass:"sk-circle sk-circle-12"})])]):e._e()],1)])}),[],!1,null,null,null);t.default=c.exports},a434:function(e,t,a){"use strict";var n=a("23e7"),l=a("23cb"),r=a("a691"),i=a("50c4"),s=a("7b0b"),o=a("65f0"),c=a("8418"),d=a("1dde")("splice"),u=Math.max,h=Math.min,f=9007199254740991,p="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var a,n,d,m,g,b,v=s(this),y=i(v.length),k=l(e,y),I=arguments.length;if(0===I?a=n=0:1===I?(a=0,n=y-k):(a=I-2,n=h(u(r(t),0),y-k)),y+a-n>f)throw TypeError(p);for(d=o(v,n),m=0;m<n;m++)(g=k+m)in v&&c(d,m,v[g]);if(d.length=n,a<n){for(m=k;m<y-n;m++)b=m+a,(g=m+n)in v?v[b]=v[g]:delete v[b];for(m=y;m>y-n+a;m--)delete v[m-1]}else if(a>n)for(m=y-n;m>k;m--)b=m+a-1,(g=m+n-1)in v?v[b]=v[g]:delete v[b];for(m=0;m<a;m++)v[m+k]=arguments[m+2];return v.length=y-n+a,d}})},c91c:function(e,t,a){"use strict";t.a={oss:{sysImgPath:"http://movie-ticket.huangjinxiu.site/movie-ticket/sys/"}}},d902:function(e,t,a){"use strict";a("069c")},e8b5:function(e,t,a){var n=a("c6b6");e.exports=Array.isArray||function(e){return"Array"==n(e)}}}]);